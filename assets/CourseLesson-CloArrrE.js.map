{"version":3,"file":"CourseLesson-CloArrrE.js","sources":["../../src/pages/course/CourseLesson.vue"],"sourcesContent":["<template>\r\n  <div class=\"min-h-screen bg-gray-50\">\r\n    <!-- Header with course navigation -->\r\n    <div class=\"bg-white shadow-sm border-b\">\r\n      <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n        <div class=\"flex items-center justify-between py-4\">\r\n          <div class=\"flex items-center space-x-4\">\r\n            <router-link \r\n              :to=\"`/courses/${courseId}`\"\r\n              class=\"text-gray-400 hover:text-gray-600\"\r\n            >\r\n              ‚Üê –ù–∞–∑–∞–¥ –∫ –∫—É—Ä—Å—É\r\n            </router-link>\r\n            <div>\r\n              <h1 class=\"text-lg font-medium text-gray-900\">{{ lesson?.title }}</h1>\r\n              <p class=\"text-sm text-gray-500\">{{ course?.title }}</p>\r\n            </div>\r\n          </div>\r\n          \r\n          <div class=\"flex items-center space-x-4\">\r\n            <!-- Progress indicator -->\r\n            <div class=\"text-sm text-gray-500\">\r\n              {{ currentLessonIndex + 1 }} –∏–∑ {{ totalLessons }}\r\n            </div>\r\n            \r\n            <!-- Progress bar -->\r\n            <div class=\"w-32 bg-gray-200 rounded-full h-2\">\r\n              <div \r\n                class=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\r\n                :style=\"{ width: `${progressPercentage}%` }\"\r\n              ></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n      <div class=\"grid grid-cols-1 lg:grid-cols-4 gap-8\">\r\n        <!-- Main Content -->\r\n        <div class=\"lg:col-span-3\">\r\n          <div v-if=\"isLoading\" class=\"flex justify-center py-12\">\r\n            <div class=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\r\n          </div>\r\n          \r\n          <div v-else-if=\"lesson\" class=\"bg-white rounded-lg shadow-sm border border-gray-200\">\r\n            <!-- Lesson Header -->\r\n            <div class=\"p-6 border-b border-gray-200\">\r\n              <div class=\"flex items-center justify-between\">\r\n                <div>\r\n                  <h2 class=\"text-xl font-semibold text-gray-900\">{{ lesson.title }}</h2>\r\n                  <div class=\"flex items-center space-x-4 mt-2 text-sm text-gray-500\">\r\n                    <span class=\"flex items-center\">\r\n                      <span class=\"w-2 h-2 bg-blue-500 rounded-full mr-2\"></span>\r\n                      {{ lesson.type }}\r\n                    </span>\r\n                    <span v-if=\"lesson.duration\">{{ lesson.duration }} –º–∏–Ω</span>\r\n                  </div>\r\n                </div>\r\n                \r\n                <button\r\n                  v-if=\"!lesson.isCompleted\"\r\n                  @click=\"markAsComplete\"\r\n                  :disabled=\"isMarkingComplete\"\r\n                  class=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50\"\r\n                >\r\n                  {{ isMarkingComplete ? '–û—Ç–º–µ—á–∞—é...' : '–ó–∞–≤–µ—Ä—à–∏—Ç—å —É—Ä–æ–∫' }}\r\n                </button>\r\n                \r\n                <div v-else class=\"flex items-center text-green-600\">\r\n                  <span class=\"mr-2\">‚úì</span>\r\n                  –ó–∞–≤–µ—Ä—à–µ–Ω–æ\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Lesson Content -->\r\n            <div class=\"p-6\">\r\n              <!-- Video Content -->\r\n              <div v-if=\"lesson.type === 'video'\" class=\"mb-6\">\r\n                <div class=\"aspect-video bg-gray-900 rounded-lg flex items-center justify-center\">\r\n                  <div class=\"text-white text-center\">\r\n                    <div class=\"text-4xl mb-2\">üé•</div>\r\n                    <p>–í–∏–¥–µ–æ —É—Ä–æ–∫</p>\r\n                    <p class=\"text-sm opacity-75\">{{ lesson.duration }} –º–∏–Ω—É—Ç</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <!-- Text Content -->\r\n              <div class=\"prose max-w-none\">\r\n                <div v-html=\"lesson.content\"></div>\r\n              </div>\r\n\r\n              <!-- AI Exercise -->\r\n              <div v-if=\"lesson.type === 'ai_exercise' && lesson.aiExercise\" class=\"mt-6\">\r\n                <div class=\"bg-blue-50 border border-blue-200 rounded-lg p-6\">\r\n                  <h3 class=\"text-lg font-medium text-blue-900 mb-4\">\r\n                    ü§ñ AI –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ: {{ lesson.aiExercise.title }}\r\n                  </h3>\r\n                  <p class=\"text-blue-800 mb-4\">{{ lesson.aiExercise.description }}</p>\r\n                  \r\n                  <router-link \r\n                    :to=\"`/courses/${courseId}/exercise/${lesson.aiExercise.id}`\"\r\n                    class=\"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\r\n                  >\r\n                    –ù–∞—á–∞—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ ‚Üí\r\n                  </router-link>\r\n                </div>\r\n              </div>\r\n\r\n              <!-- Quiz -->\r\n              <div v-if=\"lesson.type === 'quiz' && lesson.quiz\" class=\"mt-6\">\r\n                <div class=\"bg-purple-50 border border-purple-200 rounded-lg p-6\">\r\n                  <h3 class=\"text-lg font-medium text-purple-900 mb-4\">\r\n                    üìù –ö–≤–∏–∑: {{ lesson.quiz.title }}\r\n                  </h3>\r\n                  <p class=\"text-purple-800 mb-4\">{{ lesson.quiz.questions.length }} –≤–æ–ø—Ä–æ—Å–æ–≤</p>\r\n                  \r\n                  <router-link \r\n                    :to=\"`/courses/${courseId}/quiz/${lesson.quiz.id}`\"\r\n                    class=\"inline-flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700\"\r\n                  >\r\n                    –ü—Ä–æ–π—Ç–∏ –∫–≤–∏–∑ ‚Üí\r\n                  </router-link>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Lesson Navigation -->\r\n            <div class=\"px-6 py-4 border-t border-gray-200 flex justify-between\">\r\n              <button\r\n                v-if=\"previousLesson\"\r\n                @click=\"goToLesson(previousLesson)\"\r\n                class=\"flex items-center px-4 py-2 text-gray-600 hover:text-gray-900\"\r\n              >\r\n                ‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π —É—Ä–æ–∫\r\n              </button>\r\n              \r\n              <button\r\n                v-if=\"nextLesson\"\r\n                @click=\"goToLesson(nextLesson)\"\r\n                class=\"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 ml-auto\"\r\n              >\r\n                –°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–∫ ‚Üí\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Sidebar with course outline -->\r\n        <div class=\"lg:col-span-1\">\r\n          <div class=\"bg-white rounded-lg shadow-sm border border-gray-200 sticky top-8\">\r\n            <div class=\"p-4 border-b border-gray-200\">\r\n              <h3 class=\"font-medium text-gray-900\">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∫—É—Ä—Å–∞</h3>\r\n            </div>\r\n            \r\n            <div class=\"max-h-96 overflow-y-auto\">\r\n              <div v-for=\"(module, moduleIndex) in course?.modules\" :key=\"module.id\" class=\"border-b border-gray-100 last:border-b-0\">\r\n                <div class=\"p-3 bg-gray-50 text-sm font-medium text-gray-700\">\r\n                  {{ module.title }}\r\n                </div>\r\n                \r\n                <div class=\"divide-y divide-gray-100\">\r\n                  <button\r\n                    v-for=\"(moduleLesson, lessonIndex) in module.lessons\"\r\n                    :key=\"moduleLesson.id\"\r\n                    @click=\"goToLesson(moduleLesson)\"\r\n                    :class=\"[\r\n                      'w-full text-left p-3 text-sm hover:bg-gray-50 flex items-center justify-between',\r\n                      moduleLesson.id === lesson?.id ? 'bg-blue-50 text-blue-700 border-r-2 border-blue-500' : 'text-gray-600'\r\n                    ]\"\r\n                  >\r\n                    <span class=\"flex items-center\">\r\n                      <span \r\n                        :class=\"[\r\n                          'w-2 h-2 rounded-full mr-2',\r\n                          moduleLesson.isCompleted ? 'bg-green-500' : \r\n                          moduleLesson.id === lesson?.id ? 'bg-blue-500' : 'bg-gray-300'\r\n                        ]\"\r\n                      ></span>\r\n                      {{ moduleLesson.title }}\r\n                    </span>\r\n                    \r\n                    <span v-if=\"moduleLesson.isCompleted\" class=\"text-green-500 text-xs\">‚úì</span>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, onMounted, watch } from 'vue';\r\nimport { useRoute, useRouter } from 'vue-router';\r\nimport { useCoursesStore } from '@/stores/courses';\r\nimport type { Lesson, Course } from '@/types';\r\n\r\nconst route = useRoute();\r\nconst router = useRouter();\r\nconst coursesStore = useCoursesStore();\r\n\r\nconst courseId = computed(() => route.params.courseId as string);\r\nconst lessonId = computed(() => route.params.lessonId as string);\r\n\r\nconst isLoading = ref(true);\r\nconst isMarkingComplete = ref(false);\r\nconst course = ref<Course | null>(null);\r\nconst lesson = ref<Lesson | null>(null);\r\n\r\nconst allLessons = computed(() => {\r\n  if (!course.value) return [];\r\n  return course.value.modules.flatMap(module => module.lessons);\r\n});\r\n\r\nconst currentLessonIndex = computed(() => {\r\n  return allLessons.value.findIndex(l => l.id === lessonId.value);\r\n});\r\n\r\nconst totalLessons = computed(() => allLessons.value.length);\r\n\r\nconst progressPercentage = computed(() => {\r\n  if (totalLessons.value === 0) return 0;\r\n  return ((currentLessonIndex.value + 1) / totalLessons.value) * 100;\r\n});\r\n\r\nconst previousLesson = computed(() => {\r\n  const index = currentLessonIndex.value;\r\n  return index > 0 ? allLessons.value[index - 1] : null;\r\n});\r\n\r\nconst nextLesson = computed(() => {\r\n  const index = currentLessonIndex.value;\r\n  return index < totalLessons.value - 1 ? allLessons.value[index + 1] : null;\r\n});\r\n\r\nconst loadLesson = async () => {\r\n  isLoading.value = true;\r\n  \r\n  try {\r\n    // Load course if not already loaded\r\n    if (!course.value || course.value.id !== courseId.value) {\r\n      course.value = await coursesStore.fetchCourse(courseId.value);\r\n    }\r\n    \r\n    // Find the lesson\r\n    const foundLesson = allLessons.value.find(l => l.id === lessonId.value);\r\n    if (!foundLesson) {\r\n      router.push(`/courses/${courseId.value}`);\r\n      return;\r\n    }\r\n    \r\n    lesson.value = foundLesson;\r\n  } catch (error) {\r\n    console.error('Failed to load lesson:', error);\r\n    router.push(`/courses/${courseId.value}`);\r\n  } finally {\r\n    isLoading.value = false;\r\n  }\r\n};\r\n\r\nconst markAsComplete = async () => {\r\n  if (!lesson.value || lesson.value.isCompleted) return;\r\n  \r\n  isMarkingComplete.value = true;\r\n  \r\n  try {\r\n    await coursesStore.markLessonComplete(courseId.value, lesson.value.id);\r\n    lesson.value.isCompleted = true;\r\n    \r\n    // Auto-advance to next lesson after a delay\r\n    setTimeout(() => {\r\n      if (nextLesson.value) {\r\n        goToLesson(nextLesson.value);\r\n      }\r\n    }, 1500);\r\n  } catch (error) {\r\n    console.error('Failed to mark lesson as complete:', error);\r\n  } finally {\r\n    isMarkingComplete.value = false;\r\n  }\r\n};\r\n\r\nconst goToLesson = (targetLesson: Lesson) => {\r\n  router.push(`/courses/${courseId.value}/lessons/${targetLesson.id}`);\r\n};\r\n\r\n// Watch for route changes to load different lessons\r\nwatch([courseId, lessonId], loadLesson, { immediate: true });\r\n\r\nonMounted(() => {\r\n  loadLesson();\r\n});\r\n</script>\r\n"],"names":["route","useRoute","router","useRouter","coursesStore","useCoursesStore","courseId","computed","lessonId","isLoading","ref","isMarkingComplete","course","lesson","allLessons","module","currentLessonIndex","totalLessons","progressPercentage","previousLesson","index","nextLesson","loadLesson","foundLesson","l","error","markAsComplete","goToLesson","targetLesson","watch","onMounted"],"mappings":"4rEA0MA,MAAMA,EAAQC,EAAS,EACjBC,EAASC,EAAU,EACnBC,EAAeC,EAAgB,EAE/BC,EAAWC,EAAS,IAAMP,EAAM,OAAO,QAAkB,EACzDQ,EAAWD,EAAS,IAAMP,EAAM,OAAO,QAAkB,EAEzDS,EAAYC,EAAI,EAAI,EACpBC,EAAoBD,EAAI,EAAK,EAC7BE,EAASF,EAAmB,IAAI,EAChCG,EAASH,EAAmB,IAAI,EAEhCI,EAAaP,EAAS,IACrBK,EAAO,MACLA,EAAO,MAAM,QAAQ,QAAQG,GAAUA,EAAO,OAAO,EADlC,CAAC,CAE5B,EAEKC,EAAqBT,EAAS,IAC3BO,EAAW,MAAM,aAAe,EAAE,KAAON,EAAS,KAAK,CAC/D,EAEKS,EAAeV,EAAS,IAAMO,EAAW,MAAM,MAAM,EAErDI,EAAqBX,EAAS,IAC9BU,EAAa,QAAU,EAAU,GAC5BD,EAAmB,MAAQ,GAAKC,EAAa,MAAS,GAChE,EAEKE,EAAiBZ,EAAS,IAAM,CACpC,MAAMa,EAAQJ,EAAmB,MACjC,OAAOI,EAAQ,EAAIN,EAAW,MAAMM,EAAQ,CAAC,EAAI,IAAA,CAClD,EAEKC,EAAad,EAAS,IAAM,CAChC,MAAMa,EAAQJ,EAAmB,MAC1B,OAAAI,EAAQH,EAAa,MAAQ,EAAIH,EAAW,MAAMM,EAAQ,CAAC,EAAI,IAAA,CACvE,EAEKE,EAAa,SAAY,CAC7Bb,EAAU,MAAQ,GAEd,GAAA,EAEE,CAACG,EAAO,OAASA,EAAO,MAAM,KAAON,EAAS,SAChDM,EAAO,MAAQ,MAAMR,EAAa,YAAYE,EAAS,KAAK,GAIxD,MAAAiB,EAAcT,EAAW,MAAM,QAAUU,EAAE,KAAOhB,EAAS,KAAK,EACtE,GAAI,CAACe,EAAa,CAChBrB,EAAO,KAAK,YAAYI,EAAS,KAAK,EAAE,EACxC,MAAA,CAGFO,EAAO,MAAQU,QACRE,EAAO,CACN,QAAA,MAAM,yBAA0BA,CAAK,EAC7CvB,EAAO,KAAK,YAAYI,EAAS,KAAK,EAAE,CAAA,QACxC,CACAG,EAAU,MAAQ,EAAA,CAEtB,EAEMiB,EAAiB,SAAY,CACjC,GAAI,GAACb,EAAO,OAASA,EAAO,MAAM,aAElC,CAAAF,EAAkB,MAAQ,GAEtB,GAAA,CACF,MAAMP,EAAa,mBAAmBE,EAAS,MAAOO,EAAO,MAAM,EAAE,EACrEA,EAAO,MAAM,YAAc,GAG3B,WAAW,IAAM,CACXQ,EAAW,OACbM,EAAWN,EAAW,KAAK,GAE5B,IAAI,QACAI,EAAO,CACN,QAAA,MAAM,qCAAsCA,CAAK,CAAA,QACzD,CACAd,EAAkB,MAAQ,EAAA,EAE9B,EAEMgB,EAAcC,GAAyB,CAC3C1B,EAAO,KAAK,YAAYI,EAAS,KAAK,YAAYsB,EAAa,EAAE,EAAE,CACrE,EAGM,OAAAC,EAAA,CAACvB,EAAUE,CAAQ,EAAGc,EAAY,CAAE,UAAW,GAAM,EAE3DQ,EAAU,IAAM,CACHR,EAAA,CAAA,CACZ"}