import{f as R,e as i,H as D,b as h,L as G,l as J,c as o,g as e,a as $,p as I,h as v,r as P,t as r,J as K,j as u,F as S,k as V,n as B,G as O,o as a}from"./vendor-DPs9fwmF.js";import{e as Q}from"./index-DeQVcCvr.js";const U={class:"min-h-screen bg-gray-50"},W={class:"bg-white shadow-sm border-b"},X={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Y={class:"flex items-center justify-between py-4"},Z={class:"flex items-center space-x-4"},ee={class:"text-lg font-medium text-gray-900"},se={class:"text-sm text-gray-500"},te={class:"flex items-center space-x-4"},le={class:"text-sm text-gray-500"},oe={class:"w-32 bg-gray-200 rounded-full h-2"},ae={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},re={class:"grid grid-cols-1 lg:grid-cols-4 gap-8"},ne={class:"lg:col-span-3"},ie={key:0,class:"flex justify-center py-12"},ue={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200"},de={class:"p-6 border-b border-gray-200"},ce={class:"flex items-center justify-between"},ve={class:"text-xl font-semibold text-gray-900"},pe={class:"flex items-center space-x-4 mt-2 text-sm text-gray-500"},xe={class:"flex items-center"},_e={key:0},be=["disabled"],ge={key:1,class:"flex items-center text-green-600"},me={class:"p-6"},ye={key:0,class:"mb-6"},he={class:"aspect-video bg-gray-900 rounded-lg flex items-center justify-center"},fe={class:"text-white text-center"},we={class:"text-sm opacity-75"},ke={class:"prose max-w-none"},Ce=["innerHTML"],$e={key:1,class:"mt-6"},Ie={class:"bg-blue-50 border border-blue-200 rounded-lg p-6"},Le={class:"text-lg font-medium text-blue-900 mb-4"},ze={class:"text-blue-800 mb-4"},je={key:2,class:"mt-6"},qe={class:"bg-purple-50 border border-purple-200 rounded-lg p-6"},Ee={class:"text-lg font-medium text-purple-900 mb-4"},Me={class:"text-purple-800 mb-4"},Te={class:"px-6 py-4 border-t border-gray-200 flex justify-between"},Fe={class:"lg:col-span-1"},Ne={class:"bg-white rounded-lg shadow-sm border border-gray-200 sticky top-8"},Se={class:"max-h-96 overflow-y-auto"},Ve={class:"p-3 bg-gray-50 text-sm font-medium text-gray-700"},Be={class:"divide-y divide-gray-100"},He=["onClick"],Ae={class:"flex items-center"},Re={key:0,class:"text-green-500 text-xs"},Qe=R({__name:"CourseLesson",setup(De){const L=D(),f=O(),z=Q(),n=i(()=>L.params.courseId),w=i(()=>L.params.lessonId),k=h(!0),_=h(!1),d=h(null),s=h(null),p=i(()=>d.value?d.value.modules.flatMap(l=>l.lessons):[]),b=i(()=>p.value.findIndex(l=>l.id===w.value)),g=i(()=>p.value.length),H=i(()=>g.value===0?0:(b.value+1)/g.value*100),j=i(()=>{const l=b.value;return l>0?p.value[l-1]:null}),m=i(()=>{const l=b.value;return l<g.value-1?p.value[l+1]:null}),q=async()=>{k.value=!0;try{(!d.value||d.value.id!==n.value)&&(d.value=await z.fetchCourse(n.value));const l=p.value.find(t=>t.id===w.value);if(!l){f.push(`/courses/${n.value}`);return}s.value=l}catch(l){console.error("Failed to load lesson:",l),f.push(`/courses/${n.value}`)}finally{k.value=!1}},A=async()=>{if(!(!s.value||s.value.isCompleted)){_.value=!0;try{await z.markLessonComplete(n.value,s.value.id),s.value.isCompleted=!0,setTimeout(()=>{m.value&&y(m.value)},1500)}catch(l){console.error("Failed to mark lesson as complete:",l)}finally{_.value=!1}}},y=l=>{f.push(`/courses/${n.value}/lessons/${l.id}`)};return G([n,w],q,{immediate:!0}),J(()=>{q()}),(l,t)=>{var E,M,T;const C=P("router-link");return a(),o("div",U,[e("div",W,[e("div",X,[e("div",Y,[e("div",Z,[$(C,{to:`/courses/${n.value}`,class:"text-gray-400 hover:text-gray-600"},{default:I(()=>t[2]||(t[2]=[v(" ← Назад к курсу ")])),_:1},8,["to"]),e("div",null,[e("h1",ee,r((E=s.value)==null?void 0:E.title),1),e("p",se,r((M=d.value)==null?void 0:M.title),1)])]),e("div",te,[e("div",le,r(b.value+1)+" из "+r(g.value),1),e("div",oe,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:K({width:`${H.value}%`})},null,4)])])])])]),e("div",ae,[e("div",re,[e("div",ne,[k.value?(a(),o("div",ie,t[3]||(t[3]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)]))):s.value?(a(),o("div",ue,[e("div",de,[e("div",ce,[e("div",null,[e("h2",ve,r(s.value.title),1),e("div",pe,[e("span",xe,[t[4]||(t[4]=e("span",{class:"w-2 h-2 bg-blue-500 rounded-full mr-2"},null,-1)),v(" "+r(s.value.type),1)]),s.value.duration?(a(),o("span",_e,r(s.value.duration)+" мин",1)):u("",!0)])]),s.value.isCompleted?(a(),o("div",ge,t[5]||(t[5]=[e("span",{class:"mr-2"},"✓",-1),v(" Завершено ")]))):(a(),o("button",{key:0,onClick:A,disabled:_.value,class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50"},r(_.value?"Отмечаю...":"Завершить урок"),9,be))])]),e("div",me,[s.value.type==="video"?(a(),o("div",ye,[e("div",he,[e("div",fe,[t[6]||(t[6]=e("div",{class:"text-4xl mb-2"},"🎥",-1)),t[7]||(t[7]=e("p",null,"Видео урок",-1)),e("p",we,r(s.value.duration)+" минут",1)])])])):u("",!0),e("div",ke,[e("div",{innerHTML:s.value.content},null,8,Ce)]),s.value.type==="ai_exercise"&&s.value.aiExercise?(a(),o("div",$e,[e("div",Ie,[e("h3",Le," 🤖 AI Упражнение: "+r(s.value.aiExercise.title),1),e("p",ze,r(s.value.aiExercise.description),1),$(C,{to:`/courses/${n.value}/exercise/${s.value.aiExercise.id}`,class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},{default:I(()=>t[8]||(t[8]=[v(" Начать упражнение → ")])),_:1},8,["to"])])])):u("",!0),s.value.type==="quiz"&&s.value.quiz?(a(),o("div",je,[e("div",qe,[e("h3",Ee," 📝 Квиз: "+r(s.value.quiz.title),1),e("p",Me,r(s.value.quiz.questions.length)+" вопросов",1),$(C,{to:`/courses/${n.value}/quiz/${s.value.quiz.id}`,class:"inline-flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700"},{default:I(()=>t[9]||(t[9]=[v(" Пройти квиз → ")])),_:1},8,["to"])])])):u("",!0)]),e("div",Te,[j.value?(a(),o("button",{key:0,onClick:t[0]||(t[0]=x=>y(j.value)),class:"flex items-center px-4 py-2 text-gray-600 hover:text-gray-900"}," ← Предыдущий урок ")):u("",!0),m.value?(a(),o("button",{key:1,onClick:t[1]||(t[1]=x=>y(m.value)),class:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 ml-auto"}," Следующий урок → ")):u("",!0)])])):u("",!0)]),e("div",Fe,[e("div",Ne,[t[10]||(t[10]=e("div",{class:"p-4 border-b border-gray-200"},[e("h3",{class:"font-medium text-gray-900"},"Содержание курса")],-1)),e("div",Se,[(a(!0),o(S,null,V((T=d.value)==null?void 0:T.modules,(x,Ge)=>(a(),o("div",{key:x.id,class:"border-b border-gray-100 last:border-b-0"},[e("div",Ve,r(x.title),1),e("div",Be,[(a(!0),o(S,null,V(x.lessons,(c,Je)=>{var F,N;return a(),o("button",{key:c.id,onClick:Pe=>y(c),class:B(["w-full text-left p-3 text-sm hover:bg-gray-50 flex items-center justify-between",c.id===((F=s.value)==null?void 0:F.id)?"bg-blue-50 text-blue-700 border-r-2 border-blue-500":"text-gray-600"])},[e("span",Ae,[e("span",{class:B(["w-2 h-2 rounded-full mr-2",c.isCompleted?"bg-green-500":c.id===((N=s.value)==null?void 0:N.id)?"bg-blue-500":"bg-gray-300"])},null,2),v(" "+r(c.title),1)]),c.isCompleted?(a(),o("span",Re,"✓")):u("",!0)],10,He)}),128))])]))),128))])])])])])])}}});export{Qe as default};
//# sourceMappingURL=CourseLesson-CloArrrE.js.map
