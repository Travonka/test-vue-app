{"version":3,"file":"Settings-XP_TW4Tg.js","sources":["../../src/pages/profile/Settings.vue"],"sourcesContent":[" <template>\r\n  <div class=\"space-y-8\">\r\n    <!-- Profile Settings -->\r\n    <div class=\"bg-white rounded-lg shadow-sm border border-gray-200\">\r\n      <div class=\"p-6 border-b border-gray-200\">\r\n        <h2 class=\"text-lg font-medium text-gray-900\">Профиль</h2>\r\n        <p class=\"text-sm text-gray-500\">Управляйте информацией вашего профиля</p>\r\n      </div>\r\n      \r\n      <form class=\"p-6 space-y-6\" @submit.prevent=\"updateProfile\">\r\n        <!-- Avatar Upload -->\r\n        <div class=\"flex items-center space-x-6\">\r\n          <div class=\"flex-shrink-0\">\r\n            <img \r\n              :src=\"form.avatar || defaultAvatar\" \r\n              :alt=\"form.fullName\"\r\n              class=\"h-20 w-20 rounded-full object-cover border-4 border-gray-200\"\r\n            />\r\n          </div>\r\n          <div>\r\n            <label class=\"block\">\r\n              <span class=\"sr-only\">Выбрать фото профиля</span>\r\n              <input\r\n                type=\"file\"\r\n                accept=\"image/*\"\r\n                @change=\"handleAvatarChange\"\r\n                class=\"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100\"\r\n              />\r\n            </label>\r\n            <p class=\"text-xs text-gray-500 mt-1\">PNG, JPG до 5MB</p>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Personal Information -->\r\n        <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n          <div>\r\n            <label for=\"fullName\" class=\"block text-sm font-medium text-gray-700\">\r\n              Полное имя\r\n            </label>\r\n            <input\r\n              id=\"fullName\"\r\n              type=\"text\"\r\n              v-model=\"form.fullName\"\r\n              class=\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\r\n              :disabled=\"isUpdating\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label for=\"email\" class=\"block text-sm font-medium text-gray-700\">\r\n              Email адрес\r\n            </label>\r\n            <input\r\n              id=\"email\"\r\n              type=\"email\"\r\n              v-model=\"form.email\"\r\n              class=\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\r\n              :disabled=\"isUpdating\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Save Button -->\r\n        <div class=\"flex justify-end\">\r\n          <button\r\n            type=\"submit\"\r\n            :disabled=\"isUpdating || !hasChanges\"\r\n            class=\"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          >\r\n            {{ isUpdating ? 'Сохранение...' : 'Сохранить изменения' }}\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n\r\n    <!-- Password Change -->\r\n    <div class=\"bg-white rounded-lg shadow-sm border border-gray-200\">\r\n      <div class=\"p-6 border-b border-gray-200\">\r\n        <h2 class=\"text-lg font-medium text-gray-900\">Изменить пароль</h2>\r\n        <p class=\"text-sm text-gray-500\">Обеспечьте безопасность вашего аккаунта</p>\r\n      </div>\r\n      \r\n      <form class=\"p-6 space-y-6\" @submit.prevent=\"changePassword\">\r\n        <div>\r\n          <label for=\"currentPassword\" class=\"block text-sm font-medium text-gray-700\">\r\n            Текущий пароль\r\n          </label>\r\n          <input\r\n            id=\"currentPassword\"\r\n            type=\"password\"\r\n            v-model=\"passwordForm.currentPassword\"\r\n            class=\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\r\n            :disabled=\"isChangingPassword\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label for=\"newPassword\" class=\"block text-sm font-medium text-gray-700\">\r\n            Новый пароль\r\n          </label>\r\n          <input\r\n            id=\"newPassword\"\r\n            type=\"password\"\r\n            v-model=\"passwordForm.newPassword\"\r\n            class=\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\r\n            :disabled=\"isChangingPassword\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label for=\"confirmNewPassword\" class=\"block text-sm font-medium text-gray-700\">\r\n            Подтвердите новый пароль\r\n          </label>\r\n          <input\r\n            id=\"confirmNewPassword\"\r\n            type=\"password\"\r\n            v-model=\"passwordForm.confirmNewPassword\"\r\n            class=\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\r\n            :disabled=\"isChangingPassword\"\r\n          />\r\n        </div>\r\n\r\n        <div class=\"flex justify-end\">\r\n          <button\r\n            type=\"submit\"\r\n            :disabled=\"isChangingPassword || !isPasswordFormValid\"\r\n            class=\"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          >\r\n            {{ isChangingPassword ? 'Изменение...' : 'Изменить пароль' }}\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n\r\n    <!-- Preferences -->\r\n    <div class=\"bg-white rounded-lg shadow-sm border border-gray-200\">\r\n      <div class=\"p-6 border-b border-gray-200\">\r\n        <h2 class=\"text-lg font-medium text-gray-900\">Настройки</h2>\r\n        <p class=\"text-sm text-gray-500\">Персонализируйте ваш опыт обучения</p>\r\n      </div>\r\n      \r\n      <div class=\"p-6 space-y-6\">\r\n        <!-- Email Notifications -->\r\n        <div class=\"flex items-center justify-between\">\r\n          <div>\r\n            <h3 class=\"text-sm font-medium text-gray-900\">Email уведомления</h3>\r\n            <p class=\"text-sm text-gray-500\">Получать уведомления о новых курсах и обновлениях</p>\r\n          </div>\r\n          <button\r\n            type=\"button\"\r\n            @click=\"preferences.emailNotifications = !preferences.emailNotifications\"\r\n            :class=\"[\r\n              'relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2',\r\n              preferences.emailNotifications ? 'bg-blue-600' : 'bg-gray-200'\r\n            ]\"\r\n          >\r\n            <span\r\n              :class=\"[\r\n                'pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out',\r\n                preferences.emailNotifications ? 'translate-x-5' : 'translate-x-0'\r\n              ]\"\r\n            />\r\n          </button>\r\n        </div>\r\n\r\n        <!-- Dark Mode -->\r\n        <div class=\"flex items-center justify-between\">\r\n          <div>\r\n            <h3 class=\"text-sm font-medium text-gray-900\">Тёмная тема</h3>\r\n            <p class=\"text-sm text-gray-500\">Включить тёмную тему интерфейса</p>\r\n          </div>\r\n          <button\r\n            type=\"button\"\r\n            @click=\"preferences.darkMode = !preferences.darkMode\"\r\n            :class=\"[\r\n              'relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2',\r\n              preferences.darkMode ? 'bg-blue-600' : 'bg-gray-200'\r\n            ]\"\r\n          >\r\n            <span\r\n              :class=\"[\r\n                'pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out',\r\n                preferences.darkMode ? 'translate-x-5' : 'translate-x-0'\r\n              ]\"\r\n            />\r\n          </button>\r\n        </div>\r\n\r\n        <!-- Language -->\r\n        <div>\r\n          <label for=\"language\" class=\"block text-sm font-medium text-gray-700\">\r\n            Язык интерфейса\r\n          </label>\r\n          <select\r\n            id=\"language\"\r\n            v-model=\"preferences.language\"\r\n            class=\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\r\n          >\r\n            <option value=\"ru\">Русский</option>\r\n            <option value=\"en\">English</option>\r\n            <option value=\"es\">Español</option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Danger Zone -->\r\n    <div class=\"bg-white rounded-lg shadow-sm border border-red-200\">\r\n      <div class=\"p-6 border-b border-red-200\">\r\n        <h2 class=\"text-lg font-medium text-red-900\">Опасная зона</h2>\r\n        <p class=\"text-sm text-red-600\">Необратимые действия с вашим аккаунтом</p>\r\n      </div>\r\n      \r\n      <div class=\"p-6\">\r\n        <button\r\n          @click=\"showDeleteConfirmation = true\"\r\n          class=\"px-4 py-2 border border-red-300 rounded-md shadow-sm text-sm font-medium text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\r\n        >\r\n          Удалить аккаунт\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Success Messages -->\r\n    <div v-if=\"successMessage\" class=\"fixed bottom-4 right-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded shadow-lg\">\r\n      {{ successMessage }}\r\n    </div>\r\n\r\n    <!-- Error Messages -->\r\n    <div v-if=\"errorMessage\" class=\"fixed bottom-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded shadow-lg\">\r\n      {{ errorMessage }}\r\n    </div>\r\n\r\n    <!-- Delete Confirmation Modal -->\r\n    <div v-if=\"showDeleteConfirmation\" class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div class=\"bg-white rounded-lg p-6 max-w-md mx-4\">\r\n        <h3 class=\"text-lg font-medium text-gray-900 mb-4\">Удалить аккаунт?</h3>\r\n        <p class=\"text-sm text-gray-600 mb-6\">\r\n          Это действие необратимо. Все ваши данные, прогресс и сертификаты будут удалены навсегда.\r\n        </p>\r\n        <div class=\"flex space-x-4\">\r\n          <button\r\n            @click=\"showDeleteConfirmation = false\"\r\n            class=\"flex-1 px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50\"\r\n          >\r\n            Отмена\r\n          </button>\r\n          <button\r\n            @click=\"deleteAccount\"\r\n            class=\"flex-1 px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-red-600 hover:bg-red-700\"\r\n          >\r\n            Удалить навсегда\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, onMounted } from 'vue';\r\nimport { useAuthStore } from '@/stores/auth';\r\nimport { userApi } from '@/services/api';\r\n\r\nconst authStore = useAuthStore();\r\n\r\n// Form states\r\nconst isUpdating = ref(false);\r\nconst isChangingPassword = ref(false);\r\nconst showDeleteConfirmation = ref(false);\r\nconst successMessage = ref('');\r\nconst errorMessage = ref('');\r\n\r\n// Profile form\r\nconst form = ref({\r\n  fullName: '',\r\n  email: '',\r\n  avatar: ''\r\n});\r\n\r\n// Password form\r\nconst passwordForm = ref({\r\n  currentPassword: '',\r\n  newPassword: '',\r\n  confirmNewPassword: ''\r\n});\r\n\r\n// Preferences\r\nconst preferences = ref({\r\n  emailNotifications: true,\r\n  darkMode: false,\r\n  language: 'ru'\r\n});\r\n\r\n// Original data for comparison\r\nconst originalForm = ref({...form.value});\r\n\r\nconst defaultAvatar = computed(() => \r\n  'https://ui-avatars.com/api/?name=' + \r\n  encodeURIComponent(form.value.fullName || 'Пользователь') + \r\n  '&background=3B82F6&color=fff'\r\n);\r\n\r\nconst hasChanges = computed(() => {\r\n  return JSON.stringify(form.value) !== JSON.stringify(originalForm.value);\r\n});\r\n\r\nconst isPasswordFormValid = computed(() => {\r\n  return (\r\n    passwordForm.value.currentPassword &&\r\n    passwordForm.value.newPassword &&\r\n    passwordForm.value.newPassword === passwordForm.value.confirmNewPassword &&\r\n    passwordForm.value.newPassword.length >= 8\r\n  );\r\n});\r\n\r\nconst showMessage = (message: string, type: 'success' | 'error') => {\r\n  if (type === 'success') {\r\n    successMessage.value = message;\r\n    errorMessage.value = '';\r\n  } else {\r\n    errorMessage.value = message;\r\n    successMessage.value = '';\r\n  }\r\n  \r\n  setTimeout(() => {\r\n    successMessage.value = '';\r\n    errorMessage.value = '';\r\n  }, 5000);\r\n};\r\n\r\nconst handleAvatarChange = async (event: Event) => {\r\n  const target = event.target as HTMLInputElement;\r\n  const file = target.files?.[0];\r\n  \r\n  if (!file) return;\r\n  \r\n  // Validate file size (5MB)\r\n  if (file.size > 5 * 1024 * 1024) {\r\n    showMessage('Файл слишком большой. Максимальный размер: 5MB', 'error');\r\n    return;\r\n  }\r\n  \r\n  try {\r\n    const result = await userApi.uploadAvatar(file);\r\n    form.value.avatar = result.avatarUrl;\r\n    showMessage('Фото профиля обновлено', 'success');\r\n  } catch (error) {\r\n    showMessage('Ошибка загрузки фото', 'error');\r\n  }\r\n};\r\n\r\nconst updateProfile = async () => {\r\n  isUpdating.value = true;\r\n  \r\n  try {\r\n    await authStore.updateProfile({\r\n      fullName: form.value.fullName,\r\n      email: form.value.email,\r\n      avatar: form.value.avatar\r\n    });\r\n    \r\n    originalForm.value = {...form.value};\r\n    showMessage('Профиль обновлён', 'success');\r\n  } catch (error) {\r\n    showMessage('Ошибка обновления профиля', 'error');\r\n  } finally {\r\n    isUpdating.value = false;\r\n  }\r\n};\r\n\r\nconst changePassword = async () => {\r\n  isChangingPassword.value = true;\r\n  \r\n  try {\r\n    // В реальном приложении здесь будет API вызов для смены пароля\r\n    await new Promise(resolve => setTimeout(resolve, 1000)); // Mock delay\r\n    \r\n    passwordForm.value = {\r\n      currentPassword: '',\r\n      newPassword: '',\r\n      confirmNewPassword: ''\r\n    };\r\n    \r\n    showMessage('Пароль изменён', 'success');\r\n  } catch (error) {\r\n    showMessage('Ошибка изменения пароля', 'error');\r\n  } finally {\r\n    isChangingPassword.value = false;\r\n  }\r\n};\r\n\r\nconst deleteAccount = async () => {\r\n  try {\r\n    // В реальном приложении здесь будет API вызов для удаления аккаунта\r\n    await new Promise(resolve => setTimeout(resolve, 1000)); // Mock delay\r\n    \r\n    await authStore.logout();\r\n    showMessage('Аккаунт удалён', 'success');\r\n  } catch (error) {\r\n    showMessage('Ошибка удаления аккаунта', 'error');\r\n  }\r\n  \r\n  showDeleteConfirmation.value = false;\r\n};\r\n\r\nonMounted(() => {\r\n  if (authStore.user) {\r\n    form.value = {\r\n      fullName: authStore.user.fullName,\r\n      email: authStore.user.email,\r\n      avatar: authStore.user.avatar || ''\r\n    };\r\n    originalForm.value = {...form.value};\r\n  }\r\n});\r\n</script>\r\n"],"names":["authStore","useAuthStore","isUpdating","ref","isChangingPassword","showDeleteConfirmation","successMessage","errorMessage","form","passwordForm","preferences","originalForm","defaultAvatar","computed","hasChanges","isPasswordFormValid","showMessage","message","type","handleAvatarChange","event","file","_a","result","userApi","updateProfile","changePassword","resolve","deleteAccount","onMounted"],"mappings":"s1CAwQA,MAAMA,EAAYC,EAAa,EAGzBC,EAAaC,EAAI,EAAK,EACtBC,EAAqBD,EAAI,EAAK,EAC9BE,EAAyBF,EAAI,EAAK,EAClCG,EAAiBH,EAAI,EAAE,EACvBI,EAAeJ,EAAI,EAAE,EAGrBK,EAAOL,EAAI,CACf,SAAU,GACV,MAAO,GACP,OAAQ,EAAA,CACT,EAGKM,EAAeN,EAAI,CACvB,gBAAiB,GACjB,YAAa,GACb,mBAAoB,EAAA,CACrB,EAGKO,EAAcP,EAAI,CACtB,mBAAoB,GACpB,SAAU,GACV,SAAU,IAAA,CACX,EAGKQ,EAAeR,EAAI,CAAC,GAAGK,EAAK,MAAM,EAElCI,EAAgBC,EAAS,IAC7B,oCACA,mBAAmBL,EAAK,MAAM,UAAY,cAAc,EACxD,8BACF,EAEMM,EAAaD,EAAS,IACnB,KAAK,UAAUL,EAAK,KAAK,IAAM,KAAK,UAAUG,EAAa,KAAK,CACxE,EAEKI,EAAsBF,EAAS,IAEjCJ,EAAa,MAAM,iBACnBA,EAAa,MAAM,aACnBA,EAAa,MAAM,cAAgBA,EAAa,MAAM,oBACtDA,EAAa,MAAM,YAAY,QAAU,CAE5C,EAEKO,EAAc,CAACC,EAAiBC,IAA8B,CAC9DA,IAAS,WACXZ,EAAe,MAAQW,EACvBV,EAAa,MAAQ,KAErBA,EAAa,MAAQU,EACrBX,EAAe,MAAQ,IAGzB,WAAW,IAAM,CACfA,EAAe,MAAQ,GACvBC,EAAa,MAAQ,IACpB,GAAI,CACT,EAEMY,EAAqB,MAAOC,GAAiB,OAE3C,MAAAC,GAAOC,EADEF,EAAM,OACD,QAAP,YAAAE,EAAe,GAE5B,GAAKD,EAGL,IAAIA,EAAK,KAAO,EAAI,KAAO,KAAM,CAC/BL,EAAY,iDAAkD,OAAO,EACrE,MAAA,CAGE,GAAA,CACF,MAAMO,EAAS,MAAMC,EAAQ,aAAaH,CAAI,EACzCb,EAAA,MAAM,OAASe,EAAO,UAC3BP,EAAY,yBAA0B,SAAS,OACjC,CACdA,EAAY,uBAAwB,OAAO,CAAA,EAE/C,EAEMS,EAAgB,SAAY,CAChCvB,EAAW,MAAQ,GAEf,GAAA,CACF,MAAMF,EAAU,cAAc,CAC5B,SAAUQ,EAAK,MAAM,SACrB,MAAOA,EAAK,MAAM,MAClB,OAAQA,EAAK,MAAM,MAAA,CACpB,EAEDG,EAAa,MAAQ,CAAC,GAAGH,EAAK,KAAK,EACnCQ,EAAY,mBAAoB,SAAS,OAC3B,CACdA,EAAY,4BAA6B,OAAO,CAAA,QAChD,CACAd,EAAW,MAAQ,EAAA,CAEvB,EAEMwB,EAAiB,SAAY,CACjCtB,EAAmB,MAAQ,GAEvB,GAAA,CAEF,MAAM,IAAI,QAAQuB,GAAW,WAAWA,EAAS,GAAI,CAAC,EAEtDlB,EAAa,MAAQ,CACnB,gBAAiB,GACjB,YAAa,GACb,mBAAoB,EACtB,EAEAO,EAAY,iBAAkB,SAAS,OACzB,CACdA,EAAY,0BAA2B,OAAO,CAAA,QAC9C,CACAZ,EAAmB,MAAQ,EAAA,CAE/B,EAEMwB,EAAgB,SAAY,CAC5B,GAAA,CAEF,MAAM,IAAI,QAAQD,GAAW,WAAWA,EAAS,GAAI,CAAC,EAEtD,MAAM3B,EAAU,OAAO,EACvBgB,EAAY,iBAAkB,SAAS,OACzB,CACdA,EAAY,2BAA4B,OAAO,CAAA,CAGjDX,EAAuB,MAAQ,EACjC,EAEA,OAAAwB,EAAU,IAAM,CACV7B,EAAU,OACZQ,EAAK,MAAQ,CACX,SAAUR,EAAU,KAAK,SACzB,MAAOA,EAAU,KAAK,MACtB,OAAQA,EAAU,KAAK,QAAU,EACnC,EACAW,EAAa,MAAQ,CAAC,GAAGH,EAAK,KAAK,EACrC,CACD"}