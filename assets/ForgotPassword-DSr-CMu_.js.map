{"version":3,"file":"ForgotPassword-DSr-CMu_.js","sources":["../../src/pages/auth/ForgotPassword.vue"],"sourcesContent":["<template>\r\n  <div class=\"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8\">\r\n    <div class=\"sm:mx-auto sm:w-full sm:max-w-md\">\r\n      <h2 class=\"mt-6 text-center text-3xl font-bold text-gray-900\">\r\n        Восстановление пароля\r\n      </h2>\r\n      <p class=\"mt-2 text-center text-sm text-gray-600\">\r\n        Введите email адрес для получения ссылки восстановления\r\n      </p>\r\n    </div>\r\n\r\n    <div class=\"mt-8 sm:mx-auto sm:w-full sm:max-w-md\">\r\n      <div class=\"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10\">\r\n        \r\n        <!-- Success Message -->\r\n        <div v-if=\"emailSent\" class=\"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded mb-6\">\r\n          <div class=\"flex\">\r\n            <div class=\"flex-shrink-0\">\r\n              <span class=\"text-green-400\">✓</span>\r\n            </div>\r\n            <div class=\"ml-3\">\r\n              <h3 class=\"text-sm font-medium\">\r\n                Письмо отправлено!\r\n              </h3>\r\n              <div class=\"mt-2 text-sm\">\r\n                <p>\r\n                  Мы отправили ссылку для восстановления пароля на {{ email }}. \r\n                  Проверьте почтовый ящик и следуйте инструкциям в письме.\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Form -->\r\n        <form v-if=\"!emailSent\" class=\"space-y-6\" @submit.prevent=\"handleSubmit\">\r\n          <!-- Error message -->\r\n          <div v-if=\"authStore.error\" class=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded\">\r\n            {{ authStore.error }}\r\n          </div>\r\n\r\n          <div>\r\n            <label for=\"email\" class=\"block text-sm font-medium text-gray-700\">\r\n              Email адрес\r\n            </label>\r\n            <div class=\"mt-1\">\r\n              <input\r\n                id=\"email\"\r\n                name=\"email\"\r\n                type=\"email\"\r\n                autocomplete=\"email\"\r\n                required\r\n                v-model=\"email\"\r\n                class=\"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\r\n                placeholder=\"your.email@example.com\"\r\n                :disabled=\"authStore.isLoading\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div>\r\n            <button\r\n              type=\"submit\"\r\n              :disabled=\"authStore.isLoading || !isEmailValid\"\r\n              class=\"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n              <span v-if=\"authStore.isLoading\" class=\"mr-2\">⏳</span>\r\n              {{ authStore.isLoading ? 'Отправка...' : 'Отправить ссылку' }}\r\n            </button>\r\n          </div>\r\n        </form>\r\n\r\n        <!-- Back to login -->\r\n        <div class=\"mt-6 text-center\">\r\n          <router-link \r\n            to=\"/login\" \r\n            class=\"text-sm text-blue-600 hover:text-blue-500 font-medium\"\r\n          >\r\n            ← Вернуться к входу\r\n          </router-link>\r\n        </div>\r\n\r\n        <!-- Resend link -->\r\n        <div v-if=\"emailSent\" class=\"mt-6 text-center\">\r\n          <button\r\n            @click=\"handleResend\"\r\n            :disabled=\"authStore.isLoading || resendCooldown > 0\"\r\n            class=\"text-sm text-blue-600 hover:text-blue-500 font-medium disabled:text-gray-400 disabled:cursor-not-allowed\"\r\n          >\r\n            {{ resendCooldown > 0 ? `Повторить через ${resendCooldown}с` : 'Отправить ещё раз' }}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, onUnmounted } from 'vue';\r\nimport { useAuthStore } from '@/stores/auth';\r\n\r\nconst authStore = useAuthStore();\r\n\r\nconst email = ref('');\r\nconst emailSent = ref(false);\r\nconst resendCooldown = ref(0);\r\nlet resendTimer: NodeJS.Timeout | null = null;\r\n\r\nconst isEmailValid = computed(() => {\r\n  return email.value && email.value.includes('@');\r\n});\r\n\r\nconst handleSubmit = async () => {\r\n  if (!isEmailValid.value) return;\r\n\r\n  try {\r\n    await authStore.resetPassword(email.value);\r\n    emailSent.value = true;\r\n    startResendCooldown();\r\n  } catch (error) {\r\n    // Error is handled by the store\r\n    console.error('Reset password failed:', error);\r\n  }\r\n};\r\n\r\nconst handleResend = async () => {\r\n  if (resendCooldown.value > 0) return;\r\n  \r\n  try {\r\n    await authStore.resetPassword(email.value);\r\n    startResendCooldown();\r\n  } catch (error) {\r\n    console.error('Resend failed:', error);\r\n  }\r\n};\r\n\r\nconst startResendCooldown = () => {\r\n  resendCooldown.value = 60; // 60 seconds cooldown\r\n  \r\n  resendTimer = setInterval(() => {\r\n    resendCooldown.value--;\r\n    if (resendCooldown.value <= 0) {\r\n      clearInterval(resendTimer!);\r\n      resendTimer = null;\r\n    }\r\n  }, 1000);\r\n};\r\n\r\nonUnmounted(() => {\r\n  if (resendTimer) {\r\n    clearInterval(resendTimer);\r\n  }\r\n});\r\n\r\n// Clear any existing errors when component mounts\r\nauthStore.clearError();\r\n</script>\r\n"],"names":["authStore","useAuthStore","email","ref","emailSent","resendCooldown","resendTimer","isEmailValid","computed","handleSubmit","startResendCooldown","error","handleResend","onUnmounted"],"mappings":"gzBAqGA,MAAMA,EAAYC,EAAa,EAEzBC,EAAQC,EAAI,EAAE,EACdC,EAAYD,EAAI,EAAK,EACrBE,EAAiBF,EAAI,CAAC,EAC5B,IAAIG,EAAqC,KAEnC,MAAAC,EAAeC,EAAS,IACrBN,EAAM,OAASA,EAAM,MAAM,SAAS,GAAG,CAC/C,EAEKO,EAAe,SAAY,CAC3B,GAACF,EAAa,MAEd,GAAA,CACI,MAAAP,EAAU,cAAcE,EAAM,KAAK,EACzCE,EAAU,MAAQ,GACEM,EAAA,QACbC,EAAO,CAEN,QAAA,MAAM,yBAA0BA,CAAK,CAAA,CAEjD,EAEMC,EAAe,SAAY,CAC3B,GAAA,EAAAP,EAAe,MAAQ,GAEvB,GAAA,CACI,MAAAL,EAAU,cAAcE,EAAM,KAAK,EACrBQ,EAAA,QACbC,EAAO,CACN,QAAA,MAAM,iBAAkBA,CAAK,CAAA,CAEzC,EAEMD,EAAsB,IAAM,CAChCL,EAAe,MAAQ,GAEvBC,EAAc,YAAY,IAAM,CACfD,EAAA,QACXA,EAAe,OAAS,IAC1B,cAAcC,CAAY,EACZA,EAAA,OAEf,GAAI,CACT,EAEA,OAAAO,EAAY,IAAM,CACZP,GACF,cAAcA,CAAW,CAC3B,CACD,EAGDN,EAAU,WAAW"}